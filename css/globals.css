/* ============================================================
GLOBAL RESETS
=============================================================== */
html, body { 
  height: 100%; /* Make the html and body fill their container (the iframe) */
  margin: 0; 
  padding: 0; 
  overflow: hidden; /* Prevent scrollbars on the main body */
}

/* ============================================================
MAP CONTAINER
=============================================================== */
#map { 
  position: absolute;
  top: 0;
  left: 0; /* Let the JS handle the left margin */
  z-index: 0;
  height: 100%; /* Make the map fill the body (which is 100% of the iframe) */
  /* Width and margin-left will be set by toggleable-menu.js */
  transition: width 0.4s ease, margin-left 0.4s ease;
}

/* ============================================================
SCALE CONTROL 
=============================================================== */
#ScaleControl { 
  position: relative; 
  top: 0; 
  left: 0; 
  width: 80px; 
}

/* ============================================================
MENU (Layer toggle UI)
=============================================================== */
#menu {
  background: #f9f9f9;
  position: absolute;
  z-index: 1;
  top: 20px; /* Add some space from the top */
  left: 20px;
  width: 180px;
  max-height: calc(100% - 40px); /* Adjust max-height to be relative to the container */
  overflow-y: auto;
  border: 1px solid rgba(0, 0, 0, 0.15);
  border-radius: 5px;
  padding: 10px;
  box-sizing: border-box;
  font-family: 'Open Sans', sans-serif;
  
  display: flex;
  flex-direction: column;
  gap: 3px;
}

#menu a {
  font-size: 12px;
  color: #404040;
  display: block;
  margin: 0;
  padding: 4px;
  text-decoration: none;
  text-align: center;
  background-color: white;
  border-radius: 5px;
  box-shadow: 0 1px 4px rgba(0, 0, 0, 0.2);
  transition: background-color 0.2s ease, box-shadow 0.2s ease;
}

#menu a:last-child {
  border: none; 
}

#menu a:hover {
  background-color: #f0f0f0;
  color: #404040;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.25);
}

#menu a.active {
  background-color: #3887be;
  color: #ffffff;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.4) inset;
}

#menu a.active:hover {
  background: #3074a4;
}

/* ============================================================
GEOCODER CONTAINER (for control buttons and search bar)
=============================================================== */
#geocoder-container {
  display: none; /* Initially hidden */
  position: absolute;
  top: 20px; /* Match menu's top position */
  left: 220px;
  z-index: 1;
  flex-direction: column;
  gap: 5px;
  width: 260px;
  
  background: #f9f9f9;
  border: 1px solid rgba(0, 0, 0, 0.15);
  border-radius: 5px;
  padding: 10px;
  box-sizing: border-box;

  max-height: calc(100% - 40px); /* Adjust max-height to be relative to the container */
  overflow-y: auto;
  overflow-x: hidden;
}

/* Geocoder input box styling */
#geocoder {
  width: 100%;
}

/* Row layout for grouped control buttons */
#geocoder-container div {
  display: flex;
  flex-direction: row;
  gap: 5px;
}

/* Override Mapbox Geocoder's default width to fit our container */
#geocoder .mapboxgl-ctrl-geocoder {
  width: 240px;
  min-width: 220px;
}

/* ============================================================
CONTROL BUTTON STYLES
=============================================================== */

/* Shared base button styling */
#geocoder-container button {
  background-size: 60%;
  background-position: center;
  background-repeat: no-repeat;
  width: 40px;
  height: 40px;
  border: none;
  background-color: white;
  border-radius: 5px;
  box-shadow: 0 1px 4px rgba(0, 0, 0, 0.3);
  cursor: pointer;
  margin-right: 5px;
}

/* Button hover effect */
#geocoder-container button:hover {
  background-color: #f0f0f0;
}

/* Style for active control buttons */
#geocoder-container button.active {
  box-shadow: 0 0 0 2px #007bff; /* Blue outline */
}

/* Individual icon images */
.mapboxgl-ctrl-point         { background-image: url('https://www.ese-llc.com/s/marker-blue-random.svg'); }
.mapboxgl-ctrl-print         { background-image: url('https://img.icons8.com/ios-glyphs/30/000000/print.png'); }
.mapboxgl-ctrl-custom-print  { background-image: url('https://east-southeast-llc.github.io/ese-map-viewer/img/custom-print.png'); }
.mapboxgl-ctrl-measure       { background-image: url('https://www.ese-llc.com/s/marker-blue-measure.svg'); }
.mapboxgl-ctrl-legend        { background-image: url('https://east-southeast-llc.github.io/ese-map-viewer/img/legend.png'); }

.mapboxgl-ctrl-point-center  { background-image: url('https://www.ese-llc.com/s/marker-blue-center.svg'); }
.mapboxgl-ctrl-parea         { background-image: url('https://www.ese-llc.com/s/square-50.png'); }
.mapboxgl-ctrl-sZoom         { background-image: url('https://www.ese-llc.com/s/scale-zoom.png'); }

.mapboxgl-ctrl-point-off     { background-image: url('https://www.ese-llc.com/s/marker-blue-off.svg'); }
.mapboxgl-ctrl-clear         { background-image: url('https://www.ese-llc.com/s/marker-blue-measure-cancel.svg'); }
.mapboxgl-ctrl-ten           { background-image: none; }

/* ============================================================
SHARE BUTTON 
=============================================================== */
#geocoder-container button.mapboxgl-ctrl-share {
  width: 100%;
  height: 40px;
  background-color: white; 
  color: black;
  font-size: 14px;
  border: none;
  border-radius: 5px;
  box-shadow: 0 1px 4px rgba(0, 0, 0, 0.3);
  cursor: pointer;
  text-align: center;
  line-height: 40px;
  margin-right: 0;
}

/* ============================================================
TOOLTIP STYLES
=============================================================== */
#custom-tooltip {
  position: absolute;
  background: rgba(0, 0, 0, 0.85);
  color: white;
  padding: 0px 4px;
  border-radius: 5px;
  font-size: 10px;
  white-space: nowrap;
  z-index: 1000;
  pointer-events: none;
  transform: translateX(-50%);
  opacity: 0; /* Start hidden */
  transition: opacity 0.3s ease; /* Smooth transition */
}

/* ============================================================
DISTANCE WINDOW ALIGNMENT
=============================================================== */
#distanceWindow div:nth-child(2) {
  text-align: right;
}

/* Styling for markers with measure distance */
.marker-label {
  font-size: 14px;
  color: black;
  background-color: white;
  padding: 3px 5px;
  border-radius: 3px;
  box-shadow: 0 1px 3px rgba(0,0,0,0.2);
  font-weight: bold;
}

/* ============================================================
INFO DISPLAY PANELS (for distance and scale)
=============================================================== */
#distance-display {
  font-size: 12px;
  color: #333;
  background: white;
  padding: 5px 10px;
  border-radius: 5px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
  margin-top: 5px;
  text-align: left;
  display: grid;
  grid-template-columns: 1fr auto;
  gap: 10px;
  max-width: 240px;
  width: 100%;
  box-sizing: border-box;
}

#scale-box {
  font-size: 12px;
  color: #333;
  background: white;
  padding: 5px 10px;
  border-radius: 5px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
  margin-top: 5px;
  text-align: left;
  max-width: 240px;
  width: 100%;
  box-sizing: border-box;
}

/* ==== LEGEND STYLES ==== */

/* main container for the legend */
#legend-box {
  background: white;
  color: #333;
  padding: 10px 15px;
  border-radius: 5px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
  margin-top: 5px;
  max-width: 240px;
  overflow-y: auto; 
  width: 100%;
  box-sizing: border-box;
  display: none; 
}

.legend-title {
  font-weight: bold;
  font-size: 14px;
  margin-top: auto;
  text-align: center;
}

.legend-item-row {
  display: flex;
  align-items: center;
  font-size: 12px;
}

.color-box {
  width: 15px;
  height: 15px;
  border: 1px solid #555;
  margin-right: 8px;
  flex-shrink: 0;
}

.color-line {
  width: 15px;
  height: 3px;
  border: 1px solid #555;
  margin-right: 8px;
  flex-shrink: 0;
}

/* ============================================================
CUSTOM PRINT BOX STYLES
=============================================================== */
#custom-print-box {
  display: none;
  background: white;
  color: #333;
  padding: 10px 15px;
  border-radius: 5px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
  margin-top: 5px;
  max-width: 240px;
  width: 100%;
  box-sizing: border-box;
}

/* Prevent toolkit popups from squashing in the flex container */
#distance-display,
#scale-box,
#legend-box,
#custom-print-box {
  flex-shrink: 0;
  min-height: 50px;
}

/* ============================================================
PRINT STYLES
=============================================================== */
@media print {
  @page {
    size: 8.5in 11in; /* Letter size, portrait orientation */
    margin: 0; /* No additional margins */
  }
  * {
    -webkit-print-color-adjust: exact; /* For Chrome, Safari, and older Edge */
    print-color-adjust: exact;          /* Standard property */
  }
  body.print-body {
    margin: 0;
    padding: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100%;
  }
}
.print-body {
    background-color: transparent;
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    display: flex;
    flex-direction: column; /* Stack pages vertically */
    align-items: center;
    position: relative;
    width: 8.5in;
}
.frame {
    width: 8in;
    height: 10.5in;
    position: relative;
    page-break-after: always; /* Ensure each frame is on a new page */
    z-index: 1;
    border: 4px solid black;
    box-sizing: border-box; 
    background: white;
    margin: 0.25in; /* Apply margin to center the frame */
}
.top-frame {
    height: 8in;
    position: relative;
}
.bottom-frame {
    height: 2.5in; 
    display: flex;
    align-items: center;
    position: relative;
}
.map-container {
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    border-bottom: 4px solid black;
}
.map-container img {
    width: 100%;
    height: 100%;
    object-fit: cover; /* Ensure the map scales properly */
}
.image-container {
    width: 2in;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
}
.image-container img {
    width: 100%;
    height: 100%;
    object-fit: contain;
}
.custom-info-frame {
    position: absolute;
    left: 10px;
    top: 10px;
    width: 2in;
    font-family: Arial, sans-serif;
    font-size: 10px;
    text-align: left;
}
.inner-frame {
    width: 2.5in;
    height: 2.5in;
    position: absolute;
    right: 0;
    top: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    text-align: center;
    padding: 4px;
    flex-direction: column; /* Stack text vertically */
}
.inner-frame span {
    display: block;
    margin-bottom: 4px; /* Space between lines */
}
.gis-map {
    font-family: 'BankGothicMd', sans-serif;
    font-style: italic;
    font-size: 14px;
}
.date, .scale, .base-map {
    font-family: Arial, sans-serif;
}
.disclaimer {
    font-size: 9px;
}
.date {
    font-size: 10px;
    margin-bottom: 0;
}
.scale {
    font-size: 11px;
}
.sources {
    font-size: 10px;
}
.massgis {
    font-size: 10px;
}
.base-map {
    font-size: 10px;
}
.inner-frame a {
    color: black;
    text-decoration: none;
}
.legend-frame {
  width: 3.3in;
  height: 2.2in; 
  padding: 5px;
  display: flex;
  flex-direction: column; /* Stack title and grid vertically */
  justify-content: flex-start;
  align-items: center;
}
.legend-print-title {
  font-family: 'BankGothicMd', sans-serif;
  font-style: italic;
  font-size: 14px;
  text-align: center;
}
.legend-grid {
  display: grid;
  width: 100%;
  grid-template-columns: 1fr; /* Single column */
  grid-template-rows: repeat(30, auto); /* More rows if needed */
  row-gap: 1.5px; /* Tighter row spacing */
  column-gap: 0;
  justify-items: center; /* Center content horizontally */
}
.legend-section {
    font-size: .1in;
    font-weight: bold;
    margin-top: 4px;
    font-family: Verdana, sans-serif;
    break-after: avoid-page; 
}
.legend-item {
    display: flex;
    font-family: Verdana, sans-serif;
    align-items: center;
    font-size: .1in;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}
.color-box {
    width: .1in;
    height: .1in;
    border: .5px solid #555;
    margin-right: 5px; /* Tighter margin */
    flex-shrink: 0;
}
.color-line {
    width: .1in;
    height: 2px;
    border: .5px solid #555;
    margin-right: 5px; /* Tighter margin */
    flex-shrink: 0;
}
.legend-item-not-present {
    font-size: .09in;
    font-style: italic;
    color: #555555;
    margin-top: 3px;
    padding-left: .1in;
    font-family: Verdana, sans-serif;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}